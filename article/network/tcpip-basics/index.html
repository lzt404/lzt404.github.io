<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TCP/IPåè®®åŸºç¡€ - lzt404çš„é¢‘é“</title>
    <link rel="icon" href="https://picx.zhimg.com/80/v2-13292511e82d6820ca79e7c866e6d207_1440w.png" type="image/png">
    <link rel="stylesheet" href="../../../assets/css/main.css">
    <link rel="stylesheet" href="../../../assets/css/dark-mode.css">
    <link rel="stylesheet" href="../../../assets/css/markdown-viewer.css">
    <!-- Using Highlight.js with GitHub theme (both light and dark) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.7.0/build/styles/github.min.css" id="highlight-light">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.7.0/build/styles/github-dark.min.css" id="highlight-dark" disabled>
    <!-- Add Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .nav-link i {
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>TCP/IPåè®®åŸºç¡€</h1>
            <button id="theme-toggle" onclick="toggleTheme()" style="background: transparent; border: none; color: white; cursor: pointer; font-size: 1.2rem;">ğŸŒ™</button>
        </div>
    </header>

    <main>
        <div class="section" style="text-align: center;">
            <div class="nav-links">
                <a href="../../../index.html" class="nav-link"><i class="fas fa-home"></i>é¦–é¡µ</a>
                <a href="../../../tools/index.html" class="nav-link"><i class="fas fa-toolbox"></i>å·¥å…·ç®±</a>
                <a href="https://www.zhihu.com/people/tongstark-42" target="_blank" class="nav-link"><i class="fab fa-zhihu"></i>çŸ¥ä¹</a>
                <a href="https://github.com/lzt404" target="_blank" class="nav-link"><i class="fab fa-github"></i>Github</a>
            </div>
        </div>

        <div class="markdown-container">
            <aside class="toc-sidebar">
                <div class="toc-header">ç›®å½•</div>
                <div id="toc" class="toc-content"></div>
            </aside>
            <article id="content" class="markdown-body"></article>
        </div>
    </main>

    <footer>
        <div class="footer-content">
            <p>&copy; <span id="current-year">2024</span> lzt404</p>
        </div>
    </footer>

    <div class="back-to-top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">â†‘</div>

    <script src="https://cdn.jsdelivr.net/npm/marked@4.3.0/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.7.0/build/highlight.min.js"></script>
    <script src="../../../assets/js/theme.js"></script>
    <script src="../../../assets/js/copy-code.js"></script>
    <script>
        // è·å–å½“å‰å¹´ä»½
        document.getElementById('current-year').textContent = new Date().getFullYear();
        
        // è¿”å›é¡¶éƒ¨æŒ‰é’®
        window.onscroll = function() {
            var backToTop = document.querySelector('.back-to-top');
            backToTop.style.display = document.documentElement.scrollTop > 300 ? 'block' : 'none';
        };

        // Markdownå¤„ç†
        async function loadMarkdown() {
            try {
                const response = await fetch('tmp.md');
                if (!response.ok) throw new Error(`Failed to load: ${response.status}`);
                const text = await response.text();
                
                // é…ç½®Markedé€‰é¡¹
                marked.setOptions({
                    highlight: function(code, lang) {
                        if (lang && hljs.getLanguage(lang)) {
                            return hljs.highlight(code, { language: lang }).value;
                        }
                        return hljs.highlightAuto(code).value;
                    },
                    breaks: true,
                    gfm: true
                });
                
                // æ¸²æŸ“Markdown
                document.getElementById('content').innerHTML = marked.parse(text);
                
                // ç”ŸæˆTOCç›®å½•
                generateTOC();
                
                // ç¡®ä¿ä»£ç é«˜äº®åº”ç”¨
                document.querySelectorAll('pre code').forEach((block) => {
                    hljs.highlightBlock(block);
                });
                
                // åº”ç”¨å½“å‰ä¸»é¢˜
                applyCurrentTheme();
            } catch (error) {
                console.error('Error loading markdown:', error);
                document.getElementById('content').innerHTML = `
                    <div class="error-message">
                        <h2>åŠ è½½å¤±è´¥</h2>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }

        // ç”Ÿæˆç›®å½•
        function generateTOC() {
            const toc = document.getElementById('toc');
            const headings = document.querySelectorAll('.markdown-body h1, .markdown-body h2, .markdown-body h3');
            toc.innerHTML = '';
            
            headings.forEach((heading, index) => {
                const id = `section-${index}`;
                heading.id = id;
                
                const level = parseInt(heading.tagName.substring(1));
                const tocItem = document.createElement('a');
                tocItem.href = `#${id}`;
                tocItem.textContent = heading.textContent;
                tocItem.classList.add('toc-item', `toc-level-${level}`);
                tocItem.style.paddingLeft = `${(level - 1) * 16}px`;
                
                toc.appendChild(tocItem);
            });
        }
        
        // åº”ç”¨å½“å‰ä¸»é¢˜åˆ°é«˜äº®æ ·å¼
        function applyCurrentTheme() {
            const isDarkMode = document.body.classList.contains('dark-mode');
            document.getElementById('highlight-light').disabled = isDarkMode;
            document.getElementById('highlight-dark').disabled = !isDarkMode;
        }
        
        // æ‰©å±•toggleThemeå‡½æ•°ï¼Œç¡®ä¿é«˜äº®ä¹Ÿè·Ÿéšä¸»é¢˜åˆ‡æ¢
        const originalToggleTheme = window.toggleTheme;
        window.toggleTheme = function() {
            if (originalToggleTheme) originalToggleTheme();
            applyCurrentTheme();
        };
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            loadMarkdown();
            
            // ç¡®ä¿ä¸»é¢˜å›¾æ ‡æ­£ç¡®æ˜¾ç¤º
            const themeToggle = document.getElementById('theme-toggle');
            if (document.body.classList.contains('dark-mode')) {
                themeToggle.textContent = 'â˜€ï¸';
            } else {
                themeToggle.textContent = 'ğŸŒ™';
            }
        });
    </script>
</body>
</html>
